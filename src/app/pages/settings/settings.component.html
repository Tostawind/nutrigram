@let settings = settingsService.settings();
@let settingLoading = settingsService.loading();
@let settingError = settingsService.error();

@let meals = mealService.meals();
@let mealLoading = mealService.loading();
@let mealError = mealService.error();

<h2 class="title--1">Configuración</h2>

@if(!settingLoading) {
  @if (settings) {
    <app-macros-table
      [macros]="[settings.macros]"
      [editableFields]="['kcal', 'protein', 'carbs', 'fat']"
      (save)="updateSettings($event)"
    />
  }
}
@if(settingLoading) {
  <p>Cargando configuración...</p>
} 

@if(settingError) {
  <p>Error al cargar configuración</p>
  <button (click)="settingsService.getSettings()">volver a cargar</button>
}

@if(!mealLoading) {
  @for(meal of meals; track meal.id) {
    <hr style="opacity: 0.2; margin-top: 32px" />
    <h3 class="title--2">{{ meal.name }}</h3>
    <app-macros-table
      [macros]="[meal.macros]"
      [editableFields]="['protein', 'carbs', 'fat']"
      (save)="updateMeal($event, meal.id)"
    />
  }
} 

@if(mealLoading) {
  <p>Cargando comidas...</p>
} 

@if(mealError) {
  <p>Error al cargar comidas</p>
  <button (click)="mealService.getMeals()">volver a cargar</button>
}

